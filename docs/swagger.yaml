basePath: /
definitions:
  models.Asignatura:
    description: Modelo de Asignatura (Curso) utilizado en la API y sincronizado con
      Moodle.
    properties:
      cuatrimestre_id:
        description: Relación de Pertenencia (Clave Foránea)
        example: 5
        type: integer
      id_externo:
        description: 'Moodle: idnumber'
        example: ASIG-POO1-2025
        type: string
      id_moodle:
        description: Sincronización con Moodle
        example: 1234
        type: integer
      nombre_completo:
        description: Datos del Curso (Obligatorios para Moodle)
        example: Programación Orientada a Objetos I
        type: string
      nombre_corto:
        description: 'Moodle: shortname'
        example: POO1-2025-A
        type: string
      resumen:
        description: Información adicional (Opcional)
        example: Curso introductorio de programación orientada a objetos que cubre
          conceptos fundamentales como clases, objetos, herencia y polimorfismo.
        type: string
    type: object
  models.Cuatrimestre:
    description: Modelo de Cuatrimestre utilizado en la API y sincronizado como subcategoría
      en Moodle.
    properties:
      descripcion:
        example: Cuatrimestre correspondiente al periodo enero-abril 2025
        type: string
      id_externo:
        example: CUATR-2025-01
        type: string
      id_moodle:
        example: 5678
        type: integer
      nombre:
        example: Primer Cuatrimestre 2025
        type: string
      programa_estudio_id:
        description: Campo de la Clave Foránea
        example: 3
        type: integer
    type: object
  models.Grupo:
    description: Modelo de Grupo utilizado en la API y sincronizado con Moodle.
    properties:
      course_id:
        description: ID de la Asignatura/Curso local
        example: 12
        type: integer
      description:
        example: Grupo de clases matutinas para el curso de Programación
        type: string
      descriptionformat:
        example: 1
        type: integer
      id_moodle:
        description: ID del Grupo devuelto por Moodle
        example: 888
        type: integer
      nombre:
        example: Grupo A - Turno Matutino
        type: string
    type: object
  models.ProgramaEstudio:
    description: Modelo de Programa de Estudio utilizado en la API y sincronizado
      como categoría padre en Moodle.
    properties:
      descripcion:
        example: Programa de estudios enfocado en el desarrollo de software y sistemas
          de información
        type: string
      id_externo:
        example: PROG-ISC-2025
        type: string
      id_moodle:
        example: 9012
        type: integer
      nombre:
        example: Ingeniería en Sistemas Computacionales
        type: string
    type: object
  models.Usuario:
    description: Modelo de Usuario utilizado en la API y sincronizado como usuario
      en Moodle. Puede ser Docente o Alumno.
    properties:
      email:
        description: OBLIGATORIO
        example: juan.perez@universidad.edu.mx
        type: string
      first_name:
        description: OBLIGATORIO
        example: Juan
        type: string
      id_moodle:
        description: ID devuelto por Moodle
        example: 3456
        type: integer
      last_name:
        description: OBLIGATORIO
        example: Pérez García
        type: string
      matricula:
        description: Uso como 'idnumber'
        example: "20250001"
        type: string
      password:
        description: OBLIGATORIO
        example: Segura123#
        type: string
      rol:
        description: '''Docente'' o ''Alumno'''
        example: Alumno
        type: string
      username:
        description: OBLIGATORIO
        example: jperez2025
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: API para gestión de Programa de Estudio, Cuatrimestres, Asignaturas,
    Usuarios y Grupos con sincronización a Moodle.
  title: Control Escolar API
  version: "2.0"
paths:
  /asignatura/:
    get:
      description: Obtiene todas las asignaturas
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Asignatura'
            type: array
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Listar Asignaturas
      tags:
      - asignatura
    post:
      consumes:
      - application/json
      description: Crea una asignatura local
      parameters:
      - description: Datos de la asignatura
        in: body
        name: asignatura
        required: true
        schema:
          $ref: '#/definitions/models.Asignatura'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Asignatura'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Crear Asignatura
      tags:
      - asignatura
  /asignatura/{id}/:
    delete:
      description: Elimina una asignatura por ID
      parameters:
      - description: ID de la asignatura
        in: path
        name: id
        required: true
        type: integer
      responses:
        "204":
          description: No Content
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Eliminar Asignatura
      tags:
      - asignatura
    get:
      description: Obtiene una asignatura por ID
      parameters:
      - description: ID de la asignatura
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Asignatura'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
      summary: Obtener Asignatura
      tags:
      - asignatura
    put:
      consumes:
      - application/json
      description: Actualiza una asignatura por ID
      parameters:
      - description: ID de la asignatura
        in: path
        name: id
        required: true
        type: integer
      - description: Datos de la asignatura
        in: body
        name: asignatura
        required: true
        schema:
          $ref: '#/definitions/models.Asignatura'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Asignatura'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Actualizar Asignatura
      tags:
      - asignatura
  /asignatura/sync/{id}:
    post:
      description: Inicia la sincronización de una asignatura a Moodle
      parameters:
      - description: ID de la asignatura
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
      summary: Sincronizar Asignatura
      tags:
      - asignatura
  /cuatrimestre/:
    get:
      description: Obtiene todos los cuatrimestres
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Cuatrimestre'
            type: array
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Listar Cuatrimestres
      tags:
      - cuatrimestre
    post:
      consumes:
      - application/json
      description: Crea un cuatrimestre local
      parameters:
      - description: Datos del cuatrimestre
        in: body
        name: cuatrimestre
        required: true
        schema:
          $ref: '#/definitions/models.Cuatrimestre'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Cuatrimestre'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Crear Cuatrimestre
      tags:
      - cuatrimestre
  /cuatrimestre/{id}/:
    delete:
      description: Elimina un cuatrimestre por ID
      parameters:
      - description: ID del cuatrimestre
        in: path
        name: id
        required: true
        type: integer
      responses:
        "204":
          description: No Content
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Eliminar Cuatrimestre
      tags:
      - cuatrimestre
    get:
      description: Obtiene un cuatrimestre por ID
      parameters:
      - description: ID del cuatrimestre
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Cuatrimestre'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
      summary: Obtener Cuatrimestre
      tags:
      - cuatrimestre
    put:
      consumes:
      - application/json
      description: Actualiza un cuatrimestre por ID
      parameters:
      - description: ID del cuatrimestre
        in: path
        name: id
        required: true
        type: integer
      - description: Datos del cuatrimestre
        in: body
        name: cuatrimestre
        required: true
        schema:
          $ref: '#/definitions/models.Cuatrimestre'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Cuatrimestre'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Actualizar Cuatrimestre
      tags:
      - cuatrimestre
  /cuatrimestre/sync/{id}:
    post:
      description: Inicia la sincronización del cuatrimestre a Moodle
      parameters:
      - description: ID del cuatrimestre
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
      summary: Sincronizar Cuatrimestre
      tags:
      - cuatrimestre
  /grupo/:
    get:
      description: Obtiene todos los grupos
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Grupo'
            type: array
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Listar Grupos
      tags:
      - grupo
    post:
      consumes:
      - application/json
      description: Crea un grupo local
      parameters:
      - description: Datos del grupo
        in: body
        name: grupo
        required: true
        schema:
          $ref: '#/definitions/models.Grupo'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Grupo'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Crear Grupo
      tags:
      - grupo
  /grupo/{id}/:
    delete:
      description: Elimina un grupo por ID
      parameters:
      - description: ID del grupo
        in: path
        name: id
        required: true
        type: integer
      responses:
        "204":
          description: No Content
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Eliminar Grupo
      tags:
      - grupo
    get:
      description: Obtiene un grupo por ID
      parameters:
      - description: ID del grupo
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Grupo'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
      summary: Obtener Grupo
      tags:
      - grupo
    put:
      consumes:
      - application/json
      description: Actualiza un grupo por ID
      parameters:
      - description: ID del grupo
        in: path
        name: id
        required: true
        type: integer
      - description: Datos del grupo
        in: body
        name: grupo
        required: true
        schema:
          $ref: '#/definitions/models.Grupo'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Grupo'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Actualizar Grupo
      tags:
      - grupo
  /grupo/add-members/{grupoID}:
    post:
      consumes:
      - application/json
      description: Añade miembros al grupo y sincroniza con Moodle
      parameters:
      - description: ID del grupo
        in: path
        name: grupoID
        required: true
        type: integer
      - description: IDs de usuarios
        in: body
        name: usuarios
        required: true
        schema:
          items:
            type: integer
          type: array
      produces:
      - text/plain
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Añadir Miembros a Grupo
      tags:
      - grupo
  /grupo/sync/{id}:
    post:
      description: Inicia la sincronización del grupo a Moodle
      parameters:
      - description: ID del grupo
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Sincronizar Grupo
      tags:
      - grupo
  /programa_estudio:
    get:
      description: Recupera la lista completa de programas de estudio
      produces:
      - application/json
      responses:
        "200":
          description: Lista de programas de estudio
          schema:
            items:
              $ref: '#/definitions/models.ProgramaEstudio'
            type: array
        "500":
          description: Error al obtener programas de estudio
          schema:
            type: string
      summary: Obtener todos los programas de estudio
      tags:
      - ProgramaEstudio
    post:
      consumes:
      - application/json
      description: Crea un nuevo programa de estudio en la base de datos local
      parameters:
      - description: Datos del programa de estudio a crear
        in: body
        name: programa_estudio
        required: true
        schema:
          $ref: '#/definitions/models.ProgramaEstudio'
      produces:
      - application/json
      responses:
        "201":
          description: Programa de estudio creado exitosamente
          schema:
            $ref: '#/definitions/models.ProgramaEstudio'
        "400":
          description: Error en los datos de entrada o campos obligatorios faltantes
          schema:
            type: string
        "500":
          description: Error interno del servidor al crear el programa de estudio
          schema:
            type: string
      summary: Crear un nuevo programa de estudio
      tags:
      - ProgramaEstudio
  /programa_estudio/{id}:
    delete:
      description: Elimina un programa de estudio de la base de datos local
      parameters:
      - description: ID del programa de estudio a eliminar
        in: path
        name: id
        required: true
        type: integer
      responses:
        "204":
          description: Programa de estudio eliminado exitosamente
        "400":
          description: ID inválido
          schema:
            type: string
        "500":
          description: Error al eliminar el programa de estudio
          schema:
            type: string
      summary: Eliminar programa de estudio
      tags:
      - ProgramaEstudio
    get:
      description: Recupera un programa de estudio específico mediante su ID
      parameters:
      - description: ID del programa de estudio
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Programa de estudio encontrado
          schema:
            $ref: '#/definitions/models.ProgramaEstudio'
        "400":
          description: ID inválido
          schema:
            type: string
        "404":
          description: Programa de estudio no encontrado
          schema:
            type: string
      summary: Obtener programa de estudio por ID
      tags:
      - ProgramaEstudio
    put:
      consumes:
      - application/json
      description: Actualiza un programa de estudio existente en la base de datos
        local
      parameters:
      - description: ID del programa de estudio a actualizar
        in: path
        name: id
        required: true
        type: integer
      - description: Datos actualizados del programa de estudio
        in: body
        name: programa_estudio
        required: true
        schema:
          $ref: '#/definitions/models.ProgramaEstudio'
      produces:
      - application/json
      responses:
        "200":
          description: Programa de estudio actualizado exitosamente
          schema:
            $ref: '#/definitions/models.ProgramaEstudio'
        "400":
          description: ID inválido o error en los datos de entrada
          schema:
            type: string
        "500":
          description: Error al actualizar el programa de estudio
          schema:
            type: string
      summary: Actualizar programa de estudio
      tags:
      - ProgramaEstudio
  /programa_estudio/sync/{id}:
    post:
      description: Sincroniza un programa de estudio local con Moodle como categoría
        padre
      parameters:
      - description: ID del programa de estudio a sincronizar
        in: path
        name: id
        required: true
        type: integer
      produces:
      - text/plain
      responses:
        "200":
          description: Sincronización iniciada correctamente
          schema:
            type: string
        "400":
          description: ID inválido
          schema:
            type: string
        "500":
          description: Error durante la sincronización
          schema:
            type: string
      summary: Sincronizar programa de estudio con Moodle
      tags:
      - ProgramaEstudio
  /usuario:
    get:
      description: Recupera la lista completa de usuarios (Docentes y Alumnos)
      produces:
      - application/json
      responses:
        "200":
          description: Lista de usuarios
          schema:
            items:
              $ref: '#/definitions/models.Usuario'
            type: array
        "500":
          description: Error al obtener usuarios
          schema:
            type: string
      summary: Obtener todos los usuarios
      tags:
      - Usuario
    post:
      consumes:
      - application/json
      description: Crea un nuevo usuario (Docente o Alumno) en la base de datos local
        con validaciones de contraseña, unicidad y rol
      parameters:
      - description: Datos del usuario a crear (Password debe tener mín. 8 caracteres,
          mayúscula, número y símbolo)
        in: body
        name: usuario
        required: true
        schema:
          $ref: '#/definitions/models.Usuario'
      produces:
      - application/json
      responses:
        "201":
          description: Usuario creado exitosamente
          schema:
            $ref: '#/definitions/models.Usuario'
        "400":
          description: Error en los datos de entrada, campos obligatorios faltantes
            o contraseña inválida
          schema:
            type: string
        "409":
          description: Ya existe un usuario con el mismo Username, Email o Matrícula
          schema:
            type: string
        "500":
          description: Error interno del servidor al crear el usuario
          schema:
            type: string
      summary: Crear un nuevo usuario
      tags:
      - Usuario
  /usuario/{id}:
    delete:
      description: Elimina un usuario de la base de datos local
      parameters:
      - description: ID del usuario a eliminar
        in: path
        name: id
        required: true
        type: integer
      responses:
        "204":
          description: Usuario eliminado exitosamente
        "400":
          description: ID inválido
          schema:
            type: string
        "500":
          description: Error al eliminar el usuario
          schema:
            type: string
      summary: Eliminar usuario
      tags:
      - Usuario
    get:
      description: Recupera un usuario específico mediante su ID
      parameters:
      - description: ID del usuario
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Usuario encontrado
          schema:
            $ref: '#/definitions/models.Usuario'
        "400":
          description: ID inválido
          schema:
            type: string
        "404":
          description: Usuario no encontrado
          schema:
            type: string
      summary: Obtener usuario por ID
      tags:
      - Usuario
    put:
      consumes:
      - application/json
      description: Actualiza un usuario existente en la base de datos local
      parameters:
      - description: ID del usuario a actualizar
        in: path
        name: id
        required: true
        type: integer
      - description: Datos actualizados del usuario
        in: body
        name: usuario
        required: true
        schema:
          $ref: '#/definitions/models.Usuario'
      produces:
      - application/json
      responses:
        "200":
          description: Usuario actualizado exitosamente
          schema:
            $ref: '#/definitions/models.Usuario'
        "400":
          description: ID inválido o error en los datos de entrada
          schema:
            type: string
        "500":
          description: Error al actualizar el usuario
          schema:
            type: string
      summary: Actualizar usuario
      tags:
      - Usuario
  /usuario/{usuarioID}/matricular/{asignaturaID}:
    post:
      description: Matricula un usuario en una asignatura de forma asíncrona (crea
        el enrolamiento en Moodle)
      parameters:
      - description: ID del usuario a matricular
        in: path
        name: usuarioID
        required: true
        type: integer
      - description: ID de la asignatura
        in: path
        name: asignaturaID
        required: true
        type: integer
      produces:
      - text/plain
      responses:
        "200":
          description: Matriculación iniciada en segundo plano
          schema:
            type: string
        "400":
          description: ID de Usuario o Asignatura inválido
          schema:
            type: string
      summary: Matricular usuario en asignatura
      tags:
      - Usuario
  /usuario/bulk-sync:
    post:
      description: Sincroniza todos los usuarios de un rol específico (Docente o Alumno)
        con Moodle de forma asíncrona
      parameters:
      - description: 'Rol a sincronizar: ''Docente'' o ''Alumno'''
        in: query
        name: role
        required: true
        type: string
      produces:
      - text/plain
      responses:
        "200":
          description: Sincronización masiva de usuarios iniciada correctamente en
            segundo plano
          schema:
            type: string
        "400":
          description: Rol inválido o no especificado
          schema:
            type: string
      summary: Sincronización masiva de usuarios por rol
      tags:
      - Usuario
  /usuario/by_group/{grupoID}:
    get:
      description: Recupera la lista de usuarios que pertenecen a un grupo específico
      parameters:
      - description: ID del grupo
        in: path
        name: grupoID
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Lista de usuarios del grupo
          schema:
            items:
              $ref: '#/definitions/models.Usuario'
            type: array
        "400":
          description: ID de Grupo inválido
          schema:
            type: string
        "500":
          description: Error al obtener usuarios por grupo
          schema:
            type: string
      summary: Obtener usuarios por ID de grupo
      tags:
      - Usuario
  /usuario/sync/{id}:
    post:
      description: Sincroniza un usuario local con Moodle de forma asíncrona
      parameters:
      - description: ID del usuario a sincronizar
        in: path
        name: id
        required: true
        type: integer
      produces:
      - text/plain
      responses:
        "200":
          description: Sincronización del Usuario iniciada correctamente en segundo
            plano
          schema:
            type: string
        "400":
          description: ID inválido
          schema:
            type: string
      summary: Sincronizar usuario con Moodle
      tags:
      - Usuario
  /usuario/unsynced:
    get:
      description: Recupera la lista de usuarios que aún no han sido sincronizados
        con Moodle, filtrados por rol
      parameters:
      - description: 'Rol a filtrar: ''Docente'' o ''Alumno'''
        in: query
        name: role
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Lista de usuarios no sincronizados
          schema:
            items:
              $ref: '#/definitions/models.Usuario'
            type: array
        "400":
          description: Rol no especificado o inválido
          schema:
            type: string
        "500":
          description: Error al obtener usuarios no sincronizados
          schema:
            type: string
      summary: Obtener usuarios no sincronizados por rol
      tags:
      - Usuario
swagger: "2.0"
